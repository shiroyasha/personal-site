<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv='X-UA-Compatible' content='IE=edge;chrome=1' />
    <title>From Javascript to Ruby, Part 1.5 &ndash; Igor Šarčević</title>
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />
    <link href="/stylesheets/layout.css" media="screen" rel="stylesheet" type="text/css" />
    
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    <link href="http://fonts.googleapis.com/css?family=Droid+Sans:400,700|Gentium+Basic&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">

  </head>
  <body>
    <div class="layout">
      
<nav>
  <a href="/"><i class="fa fa-home fa-2x"></i></a>
</nav>

<article class='postPage'>
  <header>
    <h1 class="title">From Javascript to Ruby, Part 1.5</h1>
    <!--<p>written by <a href="https://twitter.com/igor_sarcevic">@igor_sarcevic</a> ⌚ April 18, 2014</p>-->
  </header>

  <p>This post is a continuation of <a href="/posts/from-javascript-to-ruby-part-1.html">From Javascript to Ruby, Part 1</a>, and also an answer to <a href="https://twitter.com/dear_gamemaster">@dear_gamemaster</a>&rsquo;s blog <a href="http://www.pixelablaze.com/re-from-javascript-to-ruby/">post</a>
</p>

<h1>Extending classes is an antipattern</h1>

<p>I really like your first example, and for a small application that can be
in fact a viable solution. But as my application grows the need for some
utility functions/methods will probably scyrocket, and with this
approach I would effectively create public global methods, available in all the parts of my application, and I did not even mention the possible name collisions that I and my team members could easily make.</p>

<h1>Extending classes locally</h1>

<p>What would really be nice is to have a mechanism that would allow me to
extend a class or an instance locally or bound to some scope. That
way all the problems regarding name collisions and gloabal method polution
would magically fade away. For example, this would be really nifty:</p>
<pre class="highlight ruby"><span class="k">module</span> <span class="nn">ArrayPowerups</span>
  <span class="k">def</span> <span class="nf">between</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="nb">select</span> <span class="p">{</span> <span class="o">|</span><span class="n">x</span><span class="o">|</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">a</span> <span class="o">&amp;&amp;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">b</span> <span class="p">}</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">even</span>
    <span class="nb">select</span> <span class="p">{</span> <span class="o">|</span><span class="n">x</span><span class="o">|</span> <span class="n">x</span><span class="p">.</span><span class="nf">even?</span> <span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">calulate</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
  <span class="nb">Array</span><span class="p">.</span><span class="nf">extend_locally_with</span><span class="p">(</span><span class="no">ArrayPowerups</span><span class="p">)</span>

  <span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="o">]</span><span class="p">.</span><span class="nf">between</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">).</span><span class="nf">even</span>
<span class="k">end</span>

<span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="o">]</span><span class="p">.</span><span class="nf">even</span> <span class="c1"># =&gt; NoMethodError</span>
</pre>

<p>Unfortunatelly, I think there is no programming language that would provide this functionality out of the box. Maybe there is a good reason behind it?</p>

<h1>The third solution, a.k.a use what you alrady have</h1>
<pre class="highlight ruby"><span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="o">]</span><span class="p">.</span><span class="nf">select</span> <span class="p">{</span> <span class="o">|</span><span class="n">x</span><span class="o">|</span> <span class="n">x</span><span class="p">.</span><span class="nf">between?</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="n">and</span> <span class="n">x</span><span class="p">.</span><span class="nf">even?</span> <span class="p">}</span>
</pre>

<p>This is only good if I have all the functionality needed already prepared
for me. Most of the time this isn&rsquo;t true, but would be really great if it would.</p>

<h1>Using blocks and procs</h1>

<p>When I look at your code example I can see almost identical behaviour
expressed with totally different implementation. I am of course talking
about <code>show</code> and <code>lessThen</code>. They are both methods, both of them do
things, but one is &ldquo;wierd&rdquo; and the other is &ldquo;normal&rdquo; when I consider
they implementation.</p>

<p>The other more important thing is, I can&rsquo;t call show as a normal function.</p>
<pre class="highlight ruby"><span class="n">show</span> <span class="o">=</span> <span class="no">Proc</span><span class="p">.</span><span class="nf">new</span> <span class="p">{</span> <span class="o">|</span><span class="n">msg</span><span class="o">|</span> <span class="nb">puts</span> <span class="n">msg</span> <span class="p">}</span>

<span class="n">show</span> <span class="s2">"Hello world!"</span> <span class="c1"># This does not work</span>
</pre>

<p>That really bugs me. I can&rsquo;t reuse my methods as efficiently as
in Javascript. Or I would create a normal method, and a Proc which invokes that method.</p>
<pre class="highlight ruby"><span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
  <span class="nb">puts</span> <span class="n">msg</span>
<span class="k">end</span>

<span class="n">show_proc</span> <span class="o">=</span> <span class="no">Proc</span><span class="p">.</span><span class="nf">new</span> <span class="p">{</span> <span class="o">|</span><span class="n">msg</span><span class="o">|</span> <span class="n">show</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="p">}</span>

<span class="n">show</span><span class="p">(</span><span class="s2">"Hello world"</span><span class="p">)</span> <span class="c1"># works</span>
<span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="o">]</span><span class="p">.</span><span class="nf">each</span><span class="p">(</span><span class="o">&amp;</span><span class="ss">:show</span><span class="p">)</span> <span class="c1"># this also works</span>
</pre>

<p>Alternatively, I could use this really unconfortable syntax and write</p>
<pre class="highlight ruby"><span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
  <span class="nb">puts</span> <span class="n">msg</span>
<span class="k">end</span>

<span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="o">]</span><span class="p">.</span><span class="nf">each</span><span class="p">(</span><span class="o">&amp;</span><span class="nb">method</span><span class="p">(</span><span class="ss">:show</span><span class="p">))</span>
</pre>

<p>But I can&rsquo;t do the same with less_then if I wan&rsquo;t to use it&rsquo;s returned method as I would use a normal method.</p>

</article>

<div id="disqus_thread"></div>
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'shiroyashablog'; // required: replace example with your forum shortname
var disqus_identifier = 'b079b91c-f47a-4a33-abb4-0d65c7fcbd08'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
 var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
 dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
 (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
 })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



    </div>

    <div class="follow">
      <a href="https://twitter.com/igor_sarcevic" class="twitter-follow-button" data-show-count="false">Follow @igor_sarcevic</a>
      <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
    </div>

    <footer>
      Created with <strong>❤</strong> by Igor Šarčević 
    </footer>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-50657716-1', 'shiroyasha.github.io');
  ga('send', 'pageview');

</script>


  </body>
</html>
